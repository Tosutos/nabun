# NABUN 개발 계획

## 소개
- 쓰레기를 스캔해 분류하고, 분리배출 방법과 리워드를 제공하는 환경 습관 형성 앱.
- Next.js 기반 웹/앱 경험을 목표로 하며, Teachable Machine 이미지 모델(`public/models`)을 활용해 분류.

## 문제 정의 & 가치
- 분리배출 기준이 지역/재질별로 달라 혼동이 많음.
- 올바른 분류 행동을 보상하고, 반복 사용을 통해 습관화를 유도.

## 핵심 기능
- `스캔`: 실시간 카메라 스트림으로 TM 모델 분류(`box, glass, metal, paper, plastic, trash`) 수행. 프레임마다 추론하여 결과 안정화(이동 평균) 후 확정.
- `안내`: 분류 결과에 따른 배출 가이드(텍스트/아이콘) + 추가 질문을 위한 AI 챗봇.
- `리워드`: 재질별 차등 포인트 지급, 누적 포인트에 따라 성장하는 나무 UI.
- `프로필`: 로그인/계정, 포인트·히스토리, 고객센터 진입.
- `내비게이션`: 하단 탭(홈 / 스캔(+) / 프로필).

## 화면 구성
- 홈: 상단 포인트, 중앙 성장 나무(포인트 구간에 따른 단계 이미지), 최근 스캔/리워드 카드.
- 스캔(+): 실시간 카메라 온/오프, 프레임별 추론 → 결과 스택/안정화 → 배출 방법 → 챗봇 후속 질문 → 리워드 확인. 카메라 미지원 시 이미지 업로드 대체 플로우.
- 프로필: 계정 정보, 히스토리 링크, 설정/고객센터.

## 기술 스택 & 구조 제안
- Next.js(App Router) + TypeScript, 스타일(선호하는 UI 라이브러리 또는 Tailwind/Vanilla).
- 상태: React state로 시작, 후에 전역 상태가 필요하면 Zustand/Redux 검토.
- ML: @teachablemachine/image 로 TM 모델 로드(`model.json`, `metadata.json`), 클라이언트 추론 우선. `getUserMedia`로 카메라 스트림 획득 → `<video>` 렌더 → `canvas`에서 프레임 추출 → 모델 추론. 모바일·데스크톱 호환성 점검, HTTPS 환경 전제.
- 성능/UX: 저사양 기기 대응을 위해 추론 주기/해상도 제한, 모델 로딩 상태 표시, 권한 거부/오류 핸들링(문구 + 업로드 플랜 B).
- 자산: 나무 성장 단계 이미지/아이콘은 `public` 폴더에 배치.

## 데이터/도메인 모델 초안
- User: id, displayName, region(optional), point, treeLevel.
- ScanRecord: id, userId, label(`box|glass|metal|paper|plastic|trash`), confidence, createdAt, reward.
- RewardRule: label → point, badge(optional).
- FAQ/Guide: label별 분리배출 안내 텍스트와 아이콘 매핑.

## 리워드 및 성장 규칙(초안)
- 라벨별 포인트: `plastic 5 / paper 4 / metal 4 / glass 4 / box 3 / trash 1`.
- 성장 단계: 예) 0~20 씨앗, 21~50 새싹, 51~100 작은 나무, 101~ 상록. 단계별 이미지로 표시.
- 일일 보상 캡/연속 사용 보너스는 추후 설정.

## 개발 로드맵
1) 환경 세팅: Next.js, TypeScript, ESLint/Prettier, 기본 레이아웃/탭 바.
2) TM 모델 연동: 클라이언트에서 모델 로드 & 단일 이미지 추론 흐름 구현, 결과 렌더링.
3) 가이드 매핑: 라벨별 배출 안내/아이콘/보상 표 준비 및 UI 연결.
4) 리워드/성장: 포인트 적립, 트리 레벨 계산, 홈 화면 트리 표시.
5) 챗봇 연동: 기본 QA(정적/FAQ) → 필요 시 LLM API 연동으로 확장.
6) 프로필/히스토리: 스캔 기록 리스트, 고객센터/설정 링크.
7) 배포/성능: 이미지 압축, 로드 성능 확인, PWA 옵션 검토.

## 품질 확보
- TM 모델 출력에 대한 단위 테스트(라벨 매핑, 포인트 계산).
- 주요 컴포넌트 스냅샷/렌더 테스트.
- 모바일 브라우저 뷰에서 UI 리그레이션 확인.

## 실행 방법(개발)
- `npm install`
- `npm run dev` → `http://localhost:3000`
- 카메라 권한 요청 시 허용(HTTPS 또는 로컬호스트 필요).
- PWA: `manifest.webmanifest` + `sw.js` 등록, 아이콘(192/512). 로컬 개발은 `http://localhost`에서, 배포 시 HTTPS 필요. 스탠드얼론 모드에서 하단 탭이 앱처럼 보입니다.

## 열린 질문
- 목표 플랫폼: 모바일 웹 우선인지, 스토어 배포(배포 타깃)까지 고려할지?
- 로그인 방식: 소셜 로그인/익명 로그인 여부.
- 챗봇: 외부 LLM 사용 시 모델/비용/프라이버시 정책.
- 리워드 활용: 포인트 사용처(쿠폰/기부/트로피) 계획 여부.
